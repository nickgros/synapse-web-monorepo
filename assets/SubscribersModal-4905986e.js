import{a as y,j as c}from"./jsx-runtime-095bf462.js";import{C as f}from"./ConfirmationDialog-196fa300.js";import{u,az as l,cL as p,aF as d,cM as I,cN as D,cO as T}from"./EntityTypeUtils-80a22eb6.js";import{u as b}from"./useMutation-76a8b48d.js";import{D as E}from"./EntityChildren-7cd71d6e.js";import{r as g}from"./index-8db94870.js";import"./getEndpoint-ac94413e.js";import{U}from"./UserCard-2dc60174.js";import{S as M}from"./SynapseConstants-667d004c.js";import{L as O}from"./Link-2921f78c.js";var R=(e=>(e.FORUM="FORUM",e.THREAD="THREAD",e.DATA_ACCESS_SUBMISSION="DATA_ACCESS_SUBMISSION",e.DATA_ACCESS_SUBMISSION_STATUS="DATA_ACCESS_SUBMISSION_STATUS",e))(R||{}),C=(e=>(e.SUBSCRIPTION_ID="SUBSCRIPTION_ID",e.SUBSCRIBER_ID="SUBSCRIBER_ID",e.OBJECT_ID="OBJECT_ID",e.OBJECT_TYPE="OBJECT_TYPE",e.CREATED_ON="CREATED_ON",e))(C||{});function B(e,s){const{accessToken:i,keyFactory:t}=u();return l(t.getSubscribersQueryKey(e.objectId,e.objectType),()=>p(i,e),s)}function L(e,s,i){const{accessToken:t,keyFactory:r}=u(),a=async()=>{const n={objectType:s,idList:[e],sortByType:C.OBJECT_ID,sortDirection:E.ASC};return(await T(t,n)).results[0]};return l(r.getSubscriptionQueryKey(e,s),a,i)}function N(e){const s=d(),{accessToken:i,keyFactory:t}=u();return b(r=>I(i,r),{...e,onSuccess:async(r,a,n)=>{await s.invalidateQueries(t.getAllSubscriptionsQueryKey()),await s.invalidateQueries(t.getSubscribersQueryKey(a.objectId,a.objectType)),e!=null&&e.onSuccess&&await e.onSuccess(r,a,n)}})}function w(e){const s=d(),{accessToken:i,keyFactory:t}=u();return b(r=>D(i,r),{...e,onSuccess:async(r,a,n)=>{await s.invalidateQueries(t.getAllSubscriptionsQueryKey()),await s.invalidateQueries(t.getAllSubscribersQueryKey()),e!=null&&e.onSuccess&&await e.onSuccess(r,a,n)}})}const k=(e,s)=>{const{data:i,isLoading:t}=L(e,s),{data:r}=B({objectId:e,objectType:s}),{mutate:a,isLoading:n}=N(),{mutate:o,isLoading:m}=w(),_=t||n||m,A=g.useCallback(()=>{i?o(i.subscriptionId):a({objectId:e,objectType:s})},[o,e,s,a,i]);return{isLoading:_,subscription:i,toggleSubscribed:A,subscribers:r}},S=({id:e,objectType:s,showModal:i,handleModal:t})=>{const{subscribers:r}=k(e,s);return y("div",{className:"SubscribersModal",children:[r&&r.subscribers.length>0&&c(O,{onClick:()=>t(!0),children:`Followers (${r.subscribers.length})`}),c(f,{open:i,onCancel:()=>t(!1),title:"Followers",content:r&&r.subscribers.map(a=>c(U,{ownerId:a,size:M,showCardOnHover:!0},a)),onConfirm:()=>t(!1),confirmButtonText:"Ok",hasCancelButton:!1})]})};try{S.displayName="SubscribersModal",S.__docgenInfo={description:"",displayName:"SubscribersModal",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},objectType:{defaultValue:null,description:"",name:"objectType",required:!0,type:{name:"enum",value:[{value:'"FORUM"'},{value:'"THREAD"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'}]}},showModal:{defaultValue:null,description:"",name:"showModal",required:!0,type:{name:"boolean"}},handleModal:{defaultValue:null,description:"",name:"handleModal",required:!0,type:{name:"(a: boolean) => void"}}}}}catch{}export{R as S,S as a,k as u};
//# sourceMappingURL=SubscribersModal-4905986e.js.map
