{"version":3,"file":"UserOrTeamBadge-092978d9.js","sources":["../../src/synapse-queries/user/useUserGroupHeader.ts","../../src/components/TeamBadge.tsx","../../src/components/UserOrTeamBadge/UserOrTeamBadge.tsx"],"sourcesContent":["import { useQuery, UseQueryOptions } from 'react-query'\nimport SynapseClient from '../../synapse-client'\nimport { SynapseClientError } from '../../utils/SynapseClientError'\nimport { useSynapseContext } from '../../utils/context/SynapseContext'\nimport { TYPE_FILTER, UserGroupHeader } from '@sage-bionetworks/synapse-types'\n\nexport function useGetUserGroupHeader(\n  principalId: string,\n  options?: UseQueryOptions<UserGroupHeader, SynapseClientError>,\n) {\n  const { accessToken, keyFactory } = useSynapseContext()\n  const queryKey = keyFactory.getUserGroupHeaderQueryKey(principalId)\n\n  return useQuery<UserGroupHeader, SynapseClientError>(\n    queryKey,\n    async () => {\n      const responsePage = await SynapseClient.getGroupHeadersBatch(\n        [principalId],\n        accessToken,\n      )\n      if (responsePage.children.length !== 1) {\n        throw new Error(\n          `Expected one response in useGetUserGroupHeader for id: ${principalId}, got ${responsePage.children.length}`,\n        )\n      }\n      return responsePage.children[0]\n    },\n    options,\n  )\n}\n\nexport function useSearchUserGroupHeaders(\n  prefix: string,\n  filter?: TYPE_FILTER,\n  options?: UseQueryOptions<UserGroupHeader[], SynapseClientError>,\n) {\n  const { keyFactory } = useSynapseContext()\n  const queryKey = keyFactory.getUserGroupHeaderSearchQueryKey(prefix, filter)\n\n  return useQuery<UserGroupHeader[], SynapseClientError>(\n    queryKey,\n    async () => {\n      const responsePage = await SynapseClient.getUserGroupHeaders(\n        prefix,\n        filter,\n      )\n      return responsePage.children\n    },\n    options,\n  )\n}\n\nexport function useGetUserGroupHeaderWithAlias(\n  aliases: string[],\n  options?: UseQueryOptions<UserGroupHeader[], SynapseClientError>,\n) {\n  const { keyFactory } = useSynapseContext()\n\n  const queryKey = keyFactory.getUserGroupHeaderWithAliasQueryKey(aliases)\n\n  return useQuery<UserGroupHeader[], SynapseClientError>(\n    queryKey,\n    async () => {\n      const response = await SynapseClient.postUserGroupHeadersWithAlias(\n        aliases,\n      )\n      return response.list\n    },\n    options,\n  )\n}\n","import React from 'react'\nimport { PRODUCTION_ENDPOINT_CONFIG } from '../utils/functions/getEndpoint'\nimport IconSvg, { IconName } from './IconSvg/IconSvg'\nimport {\n  AUTHENTICATED_PRINCIPAL_ID,\n  PUBLIC_PRINCIPAL_ID,\n} from '../utils/SynapseConstants'\n\nexport type TeamBadgeProps = {\n  teamId: string | number\n  teamName: string\n  disableHref?: boolean\n}\n\nexport default function TeamBadge(props: TeamBadgeProps) {\n  const { teamId } = props\n  let { teamName, disableHref } = props\n\n  let icon: IconName = 'team'\n\n  if (teamId == AUTHENTICATED_PRINCIPAL_ID) {\n    icon = 'public'\n    teamName = 'All registered Synapse users'\n    disableHref = true\n  }\n  if (teamId == PUBLIC_PRINCIPAL_ID) {\n    icon = 'public'\n    teamName = 'Anyone on the web'\n    disableHref = true\n  }\n\n  const Tag = disableHref ? 'span' : 'a'\n\n  return (\n    <span>\n      <IconSvg icon={icon} />\n      <Tag\n        style={{ marginLeft: '5px' }}\n        href={\n          disableHref\n            ? undefined\n            : `${PRODUCTION_ENDPOINT_CONFIG.PORTAL}#!Team:${teamId}`\n        }\n      >\n        {teamName}\n      </Tag>\n    </span>\n  )\n}\n","import { Skeleton } from '@mui/material'\nimport React, { useEffect, useState } from 'react'\nimport { useGetUserGroupHeader } from '../../synapse-queries/user/useUserGroupHeader'\nimport { SMALL_USER_CARD } from '../../utils/SynapseConstants'\nimport { useSynapseContext } from '../../utils/context/SynapseContext'\nimport { UserGroupHeader } from '@sage-bionetworks/synapse-types'\nimport TeamBadge from '../TeamBadge'\nimport UserCard from '../UserCard/UserCard'\n\nexport type UserOrTeamBadgeProps = {\n  /* The principal ID of the user or team. Required if userGroupHeader is undefined. */\n  principalId?: string | number\n  /* The userGroupHeader of the user or team. Required if principalId is undefined. */\n  userGroupHeader?: UserGroupHeader\n  showFullName?: boolean\n  disableHref?: boolean\n  showCardOnHover?: boolean\n}\n\nexport default function UserOrTeamBadge(props: UserOrTeamBadgeProps) {\n  let principalId = props.principalId\n  const {\n    disableHref,\n    showCardOnHover,\n    showFullName,\n    userGroupHeader: providedUserGroupHeader,\n  } = props\n\n  if (principalId == null) {\n    principalId = providedUserGroupHeader?.ownerId\n  }\n\n  const { accessToken } = useSynapseContext()\n  const [userGroupHeader, setUserGroupHeader] = useState<\n    UserGroupHeader | undefined\n  >(providedUserGroupHeader)\n\n  const { data: fetchedUserGroupHeader } = useGetUserGroupHeader(\n    (principalId ?? '').toString(),\n    {\n      enabled: !providedUserGroupHeader,\n    },\n  )\n\n  useEffect(() => {\n    if (principalId && userGroupHeader == undefined && fetchedUserGroupHeader) {\n      setUserGroupHeader(fetchedUserGroupHeader)\n    }\n  }, [accessToken, principalId, userGroupHeader, fetchedUserGroupHeader])\n\n  if (principalId == null && providedUserGroupHeader == null) {\n    console.error(\n      'Expected one of principalId or userGroupHeader to be defined but both were null or undefined',\n    )\n    return <></>\n  } else if (userGroupHeader === undefined) {\n    return <Skeleton width={125} height={30} />\n  } else if (userGroupHeader.isIndividual) {\n    return (\n      <UserCard\n        ownerId={principalId!.toString()}\n        size={SMALL_USER_CARD}\n        disableLink={disableHref}\n        showFullName={showFullName}\n        showCardOnHover={showCardOnHover}\n      />\n    )\n  } else {\n    return (\n      <TeamBadge\n        teamId={principalId!}\n        teamName={userGroupHeader.userName}\n        disableHref={disableHref}\n      />\n    )\n  }\n}\n"],"names":["useGetUserGroupHeader","principalId","options","accessToken","keyFactory","useSynapseContext","queryKey","useQuery","responsePage","SynapseClient","useSearchUserGroupHeaders","prefix","filter","useGetUserGroupHeaderWithAlias","aliases","TeamBadge","props","teamId","teamName","disableHref","icon","AUTHENTICATED_PRINCIPAL_ID","PUBLIC_PRINCIPAL_ID","jsxs","jsx","IconSvg","PRODUCTION_ENDPOINT_CONFIG","UserOrTeamBadge","showCardOnHover","showFullName","providedUserGroupHeader","userGroupHeader","setUserGroupHeader","useState","fetchedUserGroupHeader","useEffect","Fragment","Skeleton","UserCard","SMALL_USER_CARD"],"mappings":"iZAMgB,SAAAA,EACdC,EACAC,EACA,CACA,KAAM,CAAE,YAAAC,EAAa,WAAAC,CAAW,EAAIC,EAAkB,EAChDC,EAAWF,EAAW,2BAA2BH,CAAW,EAE3D,OAAAM,EACLD,EACA,SAAY,CACJ,MAAAE,EAAe,MAAMC,EAAc,qBACvC,CAACR,CAAW,EACZE,CAAA,EAEE,GAAAK,EAAa,SAAS,SAAW,EACnC,MAAM,IAAI,MACR,0DAA0DP,CAAW,SAASO,EAAa,SAAS,MAAM,EAAA,EAGvG,OAAAA,EAAa,SAAS,CAAC,CAChC,EACAN,CAAA,CAEJ,CAEgB,SAAAQ,EACdC,EACAC,EACAV,EACA,CACM,KAAA,CAAE,WAAAE,GAAeC,IACjBC,EAAWF,EAAW,iCAAiCO,EAAQC,CAAM,EAEpE,OAAAL,EACLD,EACA,UACuB,MAAMG,EAAc,oBACvCE,EACAC,CAAA,GAEkB,SAEtBV,CAAA,CAEJ,CAEgB,SAAAW,EACdC,EACAZ,EACA,CACM,KAAA,CAAE,WAAAE,GAAeC,IAEjBC,EAAWF,EAAW,oCAAoCU,CAAO,EAEhE,OAAAP,EACLD,EACA,UACmB,MAAMG,EAAc,8BACnCK,CAAA,GAEc,KAElBZ,CAAA,CAEJ,CCxDA,SAAAa,EAAAC,EAAA,CACE,KAAA,CAAA,OAAAC,CAAA,EAAAD,EACA,GAAA,CAAA,SAAAE,EAAA,YAAAC,CAAA,EAAAH,EAEAI,EAAA,OAEA,OAAAH,GAAAI,IACED,EAAA,SACAF,EAAA,+BACAC,EAAA,IAEFF,GAAAK,IACEF,EAAA,SACAF,EAAA,oBACAC,EAAA,IAKFI,EAAA,OAAA,CAAA,SAAA,CAEIC,EAAAC,EAAA,CAAA,KAAAL,EAAA,EAAqBI,EAJzBL,EAAA,OAAA,IAKK,CAAA,MAAA,CAAA,WAAA,KAAA,EAC4B,KAAAA,EAAA,OAAA,GAAAO,EAAA,MAAA,UAAAT,CAAA,GAI+B,SAAAC,CAGzD,CAAA,CACH,CAAA,CAAA,CAGN,yYC7BA,SAAAS,EAAAX,EAAA,CACE,IAAAf,EAAAe,EAAA,YACA,KAAA,CAAM,YAAAG,EACJ,gBAAAS,EACA,aAAAC,EACA,gBAAAC,CACiB,EAAAd,EAGnBf,GAAA,OACEA,EAAA6B,GAAA,YAAAA,EAAA,SAGF,KAAA,CAAA,YAAA3B,GAAAE,IACA,CAAA0B,EAAAC,CAAA,EAAAC,EAAA,SAAAH,CAAA,EAIA,CAAA,KAAAI,CAAA,EAAAlC,GAAyCC,GAAA,IAAA,SAAA,EACV,CAC7B,QAAA,CAAA6B,CACY,CACZ,EASF,OANAK,EAAAA,UAAA,IAAA,CACElC,GAAA8B,GAAA,MAAAG,GACEF,EAAAE,CAAA,CACF,EAAA,CAAA/B,EAAAF,EAAA8B,EAAAG,CAAA,CAAA,EAGFjC,GAAA,MAAA6B,GAAA,MACE,QAAA,MAAQ,8FACN,EAEFN,EAAAY,EAAA,CAAA,CAAA,GAASL,IAAA,OAETP,EAAAa,EAAA,CAAA,MAAA,IAAA,OAAA,EAAA,CAAA,EAAyCN,EAAA,aAEzCP,EACEc,EAAC,CAAA,QAAArC,EAAA,SAAA,EACgC,KAAAsC,EACzB,YAAApB,EACO,aAAAU,EACb,gBAAAD,CACA,CAAA,EAIJJ,EACET,EAAC,CAAA,OAAAd,EACS,SAAA8B,EAAA,SACkB,YAAAZ,CAC1B,CAAA,CAIR"}