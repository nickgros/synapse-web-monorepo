{"version":3,"file":"RequestDownloadCard-b7cfd030.js","sources":["../../src/synapse-queries/entity/useGetEntityHeaders.ts","../../src/components/DownloadCart/RequestDownloadCard.tsx"],"sourcesContent":["import { useQuery, UseQueryOptions } from 'react-query'\nimport SynapseClient from '../../synapse-client'\nimport { SynapseClientError } from '../../utils/SynapseClientError'\nimport { useSynapseContext } from '../../utils/context/SynapseContext'\nimport {\n  EntityHeader,\n  PaginatedResults,\n  ReferenceList,\n} from '@sage-bionetworks/synapse-types'\n\nexport function useGetEntityHeaders(\n  references: ReferenceList,\n  options?: UseQueryOptions<PaginatedResults<EntityHeader>, SynapseClientError>,\n) {\n  const { accessToken, keyFactory } = useSynapseContext()\n\n  return useQuery<PaginatedResults<EntityHeader>, SynapseClientError>(\n    keyFactory.getEntityHeadersQueryKey(references),\n    () => SynapseClient.getEntityHeaders(references, accessToken),\n    options,\n  )\n}\n\nexport function useGetEntityHeader(\n  entityId: string,\n  options?: UseQueryOptions<EntityHeader, SynapseClientError>,\n) {\n  const { accessToken, keyFactory } = useSynapseContext()\n\n  return useQuery<EntityHeader, SynapseClientError>(\n    keyFactory.getEntityHeaderQueryKey(entityId),\n    () => SynapseClient.getEntityHeader(entityId, accessToken),\n    options,\n  )\n}\n","import React from 'react'\nimport { useGetEntityHeaders } from '../../synapse-queries/entity/useGetEntityHeaders'\nimport { EntityHeader } from '@sage-bionetworks/synapse-types'\nimport { DOWNLOAD_PERMISSION_REQUIRED } from '../../utils/SynapseConstants'\nimport { Button, Typography } from '@mui/material'\nimport { ActionRequiredCard } from './ActionRequiredCard'\n\nexport type RequestDownloadCardProps = {\n  entityId: string\n  count?: number\n  /** Invoked when a user clicks \"View Sharing Settings\" for a set of files that require the Download permission*/\n  onViewSharingSettingsClicked?: (benefactorId: string) => void\n}\n\nexport const REQUEST_DOWNLOAD_TITLE = 'Download Permission Required'\nexport const RequestDownloadCard: React.FunctionComponent<\n  RequestDownloadCardProps\n> = ({\n  entityId,\n  count,\n  onViewSharingSettingsClicked = benefactorEntityId =>\n    window.open(\n      `https://www.synapse.org/#!Synapse:${benefactorEntityId}`,\n      '_blank',\n    ),\n}: RequestDownloadCardProps) => {\n  const { data, isLoading } = useGetEntityHeaders([{ targetId: entityId }], {\n    useErrorBoundary: true,\n  })\n  const entityHeader: EntityHeader | undefined = data?.results[0]\n\n  return (\n    <ActionRequiredCard\n      isLoading={isLoading}\n      title={REQUEST_DOWNLOAD_TITLE}\n      description={\n        <>\n          You must be granted the download permission on{' '}\n          <strong>{entityHeader?.name}</strong> in order to download this set of\n          files.\n        </>\n      }\n      iconType={DOWNLOAD_PERMISSION_REQUIRED}\n      count={count}\n      actionNode={\n        <>\n          <Typography variant=\"smallText1\" sx={{ mb: 1, color: 'grey.700' }}>\n            Contact an administrator to request download permission\n          </Typography>\n          <Button\n            variant=\"outlined\"\n            onClick={() => {\n              onViewSharingSettingsClicked(entityId)\n            }}\n          >\n            View Sharing Settings\n          </Button>\n        </>\n      }\n    />\n  )\n}\n"],"names":["useGetEntityHeaders","references","options","accessToken","keyFactory","useSynapseContext","useQuery","SynapseClient","useGetEntityHeader","entityId","REQUEST_DOWNLOAD_TITLE","RequestDownloadCard","count","onViewSharingSettingsClicked","benefactorEntityId","data","isLoading","entityHeader","jsx","ActionRequiredCard","jsxs","Fragment","DOWNLOAD_PERMISSION_REQUIRED","Typography","Button"],"mappings":"oTAUgB,SAAAA,EACdC,EACAC,EACA,CACA,KAAM,CAAE,YAAAC,EAAa,WAAAC,CAAW,EAAIC,EAAkB,EAE/C,OAAAC,EACLF,EAAW,yBAAyBH,CAAU,EAC9C,IAAMM,EAAc,iBAAiBN,EAAYE,CAAW,EAC5DD,CAAA,CAEJ,CAEgB,SAAAM,EACdC,EACAP,EACA,CACA,KAAM,CAAE,YAAAC,EAAa,WAAAC,CAAW,EAAIC,EAAkB,EAE/C,OAAAC,EACLF,EAAW,wBAAwBK,CAAQ,EAC3C,IAAMF,EAAc,gBAAgBE,EAAUN,CAAW,EACzDD,CAAA,CAEJ,CCpBO,MAAAQ,EAAA,+BACAC,EAAA,CAAA,CAEF,SAAAF,EACH,MAAAG,EACA,6BAAAC,EAAAC,GAAA,OAAA,KAES,qCAAAA,IACgC,QACrC,CAEN,IAAA,CACE,KAAA,CAAA,KAAAC,EAAA,UAAAC,GAAAhB,EAAA,CAAA,CAAA,SAAAS,CAAA,CAAA,EAAA,CAA0E,iBAAA,EACtD,CAAA,EAEpBQ,EAAAF,GAAA,YAAAA,EAAA,QAAA,GAEA,OAAAG,EACEC,EAAC,CAAA,UAAAH,EACC,MAAAN,EACO,YAAAU,EAAAC,EAAA,CAAA,SAAA,CAEH,iDAAA,IAC+CH,EAAA,SAAA,CAAA,SAAAD,GAAA,YAAAA,EAAA,IAAA,CAAA,EACnB,0CAAS,EAAA,EAEvC,SAAAK,EAEQ,MAAAV,EACV,WAAAQ,EAAAC,EAAA,CAAA,SAAA,CAGIH,EAAAK,EAAA,CAAA,QAAA,aAAA,GAAA,CAAA,GAAA,EAAA,MAAA,UAAA,EAAA,SAAA,yDAAA,CAAA,EAEAL,EACAM,EAAC,CAAA,QAAA,WACS,QAAA,IAAA,CAENX,EAAAJ,CAAA,CAAqC,EACvC,SAAA,uBACD,CAAA,CAED,EAAA,CACF,CAAA,CAIR;;;;"}