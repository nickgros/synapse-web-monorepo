import{j as u,F as R,a as S}from"./jsx-runtime-9dc53467.js";import{r as q}from"./index-76fb7be0.js";import{c as B,d as N,e as b}from"./useThread-fd2c62ff.js";import{h as c,n as d,m as A,l as p}from"./ApplicationSessionManager-9bd355c2.js";import{u as g}from"./useMutation-71b4db1e.js";import{u as j}from"./useInfiniteQuery-79b77040.js";import"./getEndpoint-ac94413e.js";import"./OrientationBanner-a1ca5cdb.js";import{g as G}from"./InfiniteQueryUtils-54ae7e6b.js";import{C as z,v as H,w as W}from"./HelpPopover-f7b3f4de.js";import{B as J}from"./Box-8faf86fd.js";import{F as L}from"./Form-8a372d67.js";function ce(e,s,r,a,t,n){const{accessToken:i,keyFactory:m}=c();return j({...n,queryKey:m.getRepliesQueryKey(e,s,r,a,t),queryFn:async l=>d.getReplies(i,e,r,l.pageParam,a,s,t),initialPageParam:void 0,getNextPageParam:G})}function de(e,s){const{accessToken:r,keyFactory:a}=c(),t=async()=>{const n=await d.getReplyMessageUrl(e.messageKey,r);return(await fetch(n.messageUrl,{method:"GET",headers:{Accept:"*/*","Access-Control-Request-Headers":"authorization","Content-Type":"text/plain; charset=utf-8"}})).text()};return A({...s,queryKey:a.getReplyQueryKey(e.threadId,e.id,e.messageKey),queryFn:t})}function O(e){const s=p(),{accessToken:r,keyFactory:a}=c();return g({...e,mutationFn:t=>d.postReply(t,r),onSuccess:async(t,n,i)=>{await s.invalidateQueries({queryKey:a.getAllRepliesQueryKey(t.threadId)}),e!=null&&e.onSuccess&&await e.onSuccess(t,n,i)}})}function X(e){const s=p(),{accessToken:r,keyFactory:a}=c();return g({...e,mutationFn:t=>d.putReply(t,r),onSuccess:async(t,n,i)=>{await s.invalidateQueries({queryKey:a.getAllRepliesQueryKey(t.threadId)}),e!=null&&e.onSuccess&&await e.onSuccess(t,n,i)}})}function me(e){const s=p(),{accessToken:r,keyFactory:a}=c();return g({...e,mutationFn:t=>d.deleteReply(r,t.replyId),onSuccess:async(t,n,i)=>{await s.invalidateQueries({queryKey:a.getAllRepliesQueryKey(n.threadId)}),e!=null&&e.onSuccess&&await e.onSuccess(t,n,i)}})}const F=e=>{const{initialText:s,initialTitle:r,id:a,onClose:t,isReply:n,isDialog:i,openDialog:m}=e,[l,x]=q.useState(r??""),[y,I]=q.useState(s??""),{mutate:k,isPending:w}=B({onSuccess:()=>t()}),{mutate:K,isPending:v}=N({onSuccess:()=>t()}),{mutate:Q,isPending:E}=b({onSuccess:()=>t()}),{mutate:M,isPending:D}=O({onSuccess:()=>t()}),{mutate:_,isPending:U}=X({onSuccess:()=>t()}),V=v||D||E||w||U,f=!n&&r,h=(o,P)=>{n?s?_({replyId:a,messageMarkdown:o}):M({threadId:a,messageMarkdown:o}):f?(k({title:P,threadId:a}),K({messageMarkdown:o,threadId:a})):Q({forumId:a,title:P,messageMarkdown:o})},T=S("div",{className:"bootstrap-4-backport",children:[!n&&u(L,{type:"text",placeholder:"Title",value:l,onChange:o=>x(o.target.value)}),u(W,{text:y,setText:I})]}),C=V?"Saving":"Save";return u(R,{children:i?u(z,{maxWidth:"md",open:m,onCancel:t,title:n?"Edit Reply":f?"Edit Thread":"New Thread",content:T,onConfirm:()=>h(y,l),confirmButtonProps:{children:C}}):S(R,{children:[T,u(J,{display:"flex",justifyContent:"flex-end",children:u(H,{onCancel:t,onConfirm:()=>h(y,l),confirmButtonProps:{children:C}})})]})})};try{F.displayName="ForumThreadEditor",F.__docgenInfo={description:"",displayName:"ForumThreadEditor",props:{initialTitle:{defaultValue:null,description:"",name:"initialTitle",required:!1,type:{name:"string"}},initialText:{defaultValue:null,description:"",name:"initialText",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},isReply:{defaultValue:null,description:"",name:"isReply",required:!0,type:{name:"boolean"}},isDialog:{defaultValue:null,description:"",name:"isDialog",required:!0,type:{name:"boolean"}},openDialog:{defaultValue:null,description:"",name:"openDialog",required:!1,type:{name:"boolean"}}}}}catch{}export{F,me as a,ce as b,de as u};
