import{a as E,j as g}from"./jsx-runtime-095bf462.js";import{r as i,R as T}from"./index-8db94870.js";import{P as R,o as S,q as v,r as b,s as x,t as A,v as D,w as I,x as _,f as N,y as Q,z as U,B as F}from"./EntityTypeUtils-1e303662.js";import{P as L,B as h,S as M}from"./getEndpoint-ac94413e.js";import{S as q}from"./ToastMessage-def67892.js";import{d as B}from"./dayjs.min-8d4ef725.js";import{d as j,a as G,F as W,p as H,s as K,m as V,b as $,c as z,n as J,e as X,f as Y,g as Z,h as ee,i as te,j as oe}from"./FullContextProvider-1717ae5a.js";import{c as ae}from"./styled-f64e11ba.js";import{M as ne}from"./react-router-c75a8065.js";import{Q as re}from"./queryClient-8ac0f2ae.js";function se(e={}){const{onSignInComplete:o,registerAccountUrl:a=`${L.PORTAL}#!RegisterAccount:0`,onError:t,onTwoFactorAuthRequired:p}=e,P=A(),c=new URL(window.location.href),{searchParams:n}=c,l=n==null?void 0:n.get("code"),r=n==null?void 0:n.get("provider"),C=n==null?void 0:n.get("state"),[O,f]=i.useState(!!(l&&r));return i.useEffect(()=>{if(l&&r){const y=`${P}?provider=${r}`;if(R.GOOGLE==r){const m=s=>{"accessToken"in s?x(s.accessToken).then(o):p&&p(s)},u=s=>{s.status===404&&window.location.replace(a),console.error("Error with Google account association: ",s),t&&t(s.reason)};C?S(C,r,l,y,h.REPO_ENDPOINT).then(m).catch(u).finally(()=>f(!1)):v(r,l,y,h.REPO_ENDPOINT).then(m).catch(u).finally(()=>f(!1))}else if(R.ORCID==r){const m=u=>{console.error("Error binding ORCiD to account: ",u),t&&t(u.reason)};b(r,l,y,h.REPO_ENDPOINT).then(o).catch(m).finally(()=>f(!1))}else console.warn("Unknown SSO Provider: ",r),f(!1)}},[]),{isLoading:O}}var k={exports:{}};k.exports={ReactQueryDevtools:function(){return null},ReactQueryDevtoolsPanel:function(){return null}};var ie=k.exports;async function ce(){let e=await _(),o;try{o=await N(e)}catch(t){throw t instanceof Q&&t.status===401&&(console.error("Encountered error fetching profile: ",t,"Signing out..."),await U(),e=void 0),t}let a;return e&&F(e).then(t=>{a=B(t.authenticatedOn).format("L LT")}),{accessToken:e,profile:o,authenticatedOn:a}}const d=new re(j);function le(e){const o=M[e];window.SRC={OVERRIDE_ENDPOINT_CONFIG:o},d.resetQueries()}const ue={default:H,sageBionetworks:K,mtb:V,arkPortal:$,adKnowledgePortal:z,nfPortal:J,bsmnPortal:X,psychEncodePortal:Y,stopAdPortal:Z,digitalHealthPortal:ee,crcResearcherPortal:te,cancerComplexityPortal:oe};function w(e){const{storybookContext:o}=e;i.useEffect(()=>{le(o.globals.stack)},[o.globals.stack]);const[a,t]=T.useState(void 0);se(),i.useEffect(()=>{ce().then(c=>{t(c.accessToken)})}),i.useEffect(()=>{async function c(){await d.cancelQueries(),d.removeQueries(),await d.invalidateQueries()}c()},[a]);const p=i.useMemo(()=>({accessToken:a,isInExperimentalMode:D(),utcTime:I(),withErrorBoundary:!0,downloadCartPageUrl:"/?path=/story/download-downloadcartpage--demo"}),[a]),P=ae(G,{palette:ue[o.globals.palette]});return E(W,{queryClient:d,synapseContext:p,theme:P,children:[o.globals.showReactQueryDevtools&&g(ie.ReactQueryDevtools,{}),E(ne,{children:[g(q,{}),g("main",{children:e.children})]})]},a)}try{w.displayName="StorybookComponentWrapper",w.__docgenInfo={description:"Wraps storybook story components to ensure that all components receive required context.",displayName:"StorybookComponentWrapper",props:{storybookContext:{defaultValue:null,description:"",name:"storybookContext",required:!0,type:{name:"any"}}}}}catch{}export{w as S,ce as s};
//# sourceMappingURL=StorybookComponentWrapper-4db5b78d.js.map
