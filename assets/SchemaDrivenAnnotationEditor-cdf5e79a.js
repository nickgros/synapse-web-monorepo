import{j as r,F as j,a as p}from"./jsx-runtime-9dc53467.js";import{e as K,f as Ve,H as Fe,g as qe,s as Ae,M as we,A as Ce,a as Ee,b as Ne,c as Ie,B as Pe,E as je,T as De,D as xe,d as Be,h as Oe,i as Re,j as ke}from"./ErrorListTemplate-2bc22738.js";import"./isPlainObject-cb19acc1.js";import"./mapValues-a94bd5d1.js";import{ai as he,aj as W,ak as oe,al as Le,am as ce,an as $e,ao as He,ap as Me,aq as Je,ar as ue,as as Ke,at as We,au as Ge,B as Ue,K as Xe,t as Ye,C as Ze}from"./HelpPopover-69be8750.js";import"./index.modern-ebb8621a.js";import{r as V,R as P}from"./index-76fb7be0.js";import"./index-c71daf5e.js";import{o as le,s as se,t as de,b2 as Qe,be as ze}from"./SynapseClient-7700f4cc.js";import{S as et}from"./createSvgIcon-397996e3.js";import{g as tt,B as rt}from"./getEndpoint-ac94413e.js";import"./OrientationBanner-c0eacdfc.js";import{d as at,m as nt}from"./useEntity-16b7414f.js";import{S as it}from"./LoadingScreen-ed61dd72.js";import{F as ot}from"./FullWidthAlert-77167a31.js";import{G as D}from"./Grid-eca0ba8c.js";import{I as ye}from"./InputLabel-060c2cf9.js";import{b as lt}from"./isNil-938d8733.js";import{u as st}from"./use-deep-compare-effect.esm-3f8944c0.js";import{d as dt}from"./ToastMessage-9aa3d9c5.js";import{M as ge}from"./Tooltip-e8bd1358.js";import{B as ct}from"./Button-a2b8b546.js";import{M as be,F as ut}from"./TextField-4b8d3337.js";import{I as pt}from"./IconButton-30f6f351.js";import{C as Se}from"./_getTag-dcd38d76.js";import{B as G}from"./Box-737945d6.js";import{T as U}from"./Typography-62cfc992.js";import{L as mt}from"./List-507b8078.js";import{L as ft}from"./ListItem-6176667b.js";import{M as J}from"./Alert-f631f725.js";import{L as ht}from"./Link-adab3de3.js";import{D as yt}from"./Divider-1f110b7b.js";function gt(t,e){const{accessToken:a,keyFactory:n}=le();return se(n.getEntityBoundJsonSchemaQueryKey(t),()=>de.getSchemaBinding(t,a),e)}function er(t,e){const{accessToken:a,keyFactory:n}=le();return se(n.getEntitySchemaValidationResultsQueryKey(t),()=>de.getSchemaValidationResults(t,a),e)}function bt(t,e){const{keyFactory:a}=le();return se(a.getValidationSchemaQueryKey(t),async()=>(await de.getValidationSchema(t)).validationSchema,e)}const O=t=>r(et,{...t,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:r("path",{d:"M14 10H2V12H14V10ZM14 6H2V8H14V6ZM18 14V10H16V14H12V16H16V20H18V16H22V14H18ZM2 16H10V14H2V16Z"})});try{O.displayName="AddToList",O.__docgenInfo={description:"",displayName:"AddToList",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: SVGSVGElement | null) => void) | RefObject<SVGSVGElement> | null"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any>"}}}}}catch{}const Te=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z/,St=["String","Integer","Float","Boolean","Datetime"];function X(t){return t.length===0?"String":t.every(e=>typeof e=="number"||e==="NaN")?t.every(e=>Number.isInteger(e))?"Integer":"Float":t.every(e=>typeof e=="boolean")?"Boolean":t.every(e=>typeof e=="string")&&t.every(e=>!!Te.exec(e))?"Datetime":"String"}function pe(t,e){switch(e){case"Integer":return t.map(a=>Number.isNaN(Number(a))?0:Math.floor(Number(a)));case"Float":return t.map(a=>{const n=parseFloat(a);return Number.isNaN(n)?"NaN":Number.isInteger(n)?n.toFixed(1):n});case"Datetime":return t.map(a=>typeof a=="string"&&Te.exec(a)?a:new Date().toISOString());case"Boolean":return t.map(a=>!!a);case"String":default:return t.map(a=>String(a))}}function Y(t){switch(t){case"Datetime":return{type:"string",format:"datetime"};case"Boolean":return{type:"boolean"};case"Float":return{type:"number"};case"Integer":return{type:"integer"};case"String":default:return{type:"string"}}}function Z(t){const{formData:e,onChange:a,registry:n,schema:h,name:s,onDropPropertyClick:m,idSchema:y}=t,d=y.$id,{ArrayField:g}=n.fields,{SelectWidget:f}=n.widgets,[u,b]=V.useState(X(K(e))),[o,v]=V.useState(u);V.useEffect(()=>{function i(){if(Array.isArray(e)){const T=e.length===0||e.every(_=>_==null||_==""),w=pe(e,o);(T||o!==u)&&lt(e,w)&&b(o)}}i()},[o]),V.useEffect(()=>{function i(){if(Array.isArray(e))if(e.every(T=>T==null))m(s)(new CustomEvent("dropEmptyProperty"));else{const T=pe(e,o);b(o),a(T)}}i()},[u]);const S=Y(u);return Array.isArray(e)?p(Ve,{value:{dropProperty:i=>{m(s)(i)}},children:[p(D,{item:!0,xs:2,children:[r(ye,{htmlFor:`${d}-type`,children:"Type"}),r(f,{name:"Type",id:`${d}-type`,schema:{},options:{enumOptions:St.map(i=>({label:i,value:i}))},value:u,onChange:i=>{v(i)},disabled:t.disabled,readOnly:t.readonly,required:!0,isClearable:!1,onBlur:()=>{},onFocus:()=>{},registry:n,label:"Type"})]}),r(D,{item:!0,xs:7,children:r(g,{...t,schema:{...h,items:{...S}}})}),u!==o&&r(ot,{variant:"warning",title:"Data may be lost when converting types",description:`Are you sure you want to convert ${s} from ${u} to ${o}? Current values may be lost on conversion.`,primaryButtonConfig:{text:"Convert",onClick:()=>{b(o)}},secondaryButtonConfig:{text:"Cancel",onClick:()=>{v(u)}},isGlobal:!1})]}):(a(K(e)),r(j,{}))}try{X.displayName="guessPropertyType",X.__docgenInfo={description:"",displayName:"guessPropertyType",props:{}}}catch{}try{Y.displayName="getSchemaForPropertyType",Y.__docgenInfo={description:"Maps a Synapse Annotation PropertyType to a JSON Schema that captures the type and format.",displayName:"getSchemaForPropertyType",props:{}}}catch{}try{Z.displayName="AdditionalPropertiesSchemaField",Z.__docgenInfo={description:`react-jsonschema-form SchemaField override for "additionalProperties" only. In Synapse these are "custom annotations".
Modifies the data to provide full compatibility with Synapse annotations features.

This component provides these enhancements to the SchemaField:
- Supports selecting a type, and changing the input widget appropriately
- Identifying the type on mount
- Treat all field values as arrays
- When the last array value is removed, remove the entire key from the form.`,displayName:"AdditionalPropertiesSchemaField",props:{onDropPropertyClick:{defaultValue:null,description:"",name:"onDropPropertyClick",required:!0,type:{name:"(key: string) => (event: any) => void"}}}}}catch{}function Q(t){const{description:e,disabled:a,formData:n,idSchema:h,onAddClick:s,properties:m,readonly:y,registry:d,required:g,schema:f,title:u,uiSchema:b}=t,o=he(b),v=W("TitleFieldTemplate",d,o),S=W("DescriptionFieldTemplate",d,o),i=V.useRef(new Set);return st(()=>{if("properties"in f&&f.properties){const T=Object.keys(f.properties),w=new Set(T.filter(_=>!f.properties[_][oe]));if(i.current!=null){const _=Array.from(i.current).filter(l=>!w.has(l)&&!!n&&n[l]!=null&&Array.isArray(n[l])&&n[l].filter(A=>A!=null).length>0);_.length>0&&dt(`The following annotations are no longer specified by the schema and have been converted to custom fields: ${_.join(", ")}.`,"warning",{title:"Fields No Longer Specified By Schema"})}i.current=w}},[f.properties]),p("fieldset",{id:h.$id,children:[(o.title||u)&&r(v,{id:`${h.$id}__title`,schema:f,title:o.title||u,required:g,uiSchema:b,registry:d}),(o.description||e)&&r(S,{id:`${h.$id}__description`,description:o.description||e,registry:d,schema:f}),m.map(T=>T.content),Le(f,b,n)&&r(ge,{title:"Add a new custom field",placement:"top",children:r(ct,{sx:{my:2},variant:"contained",className:"object-property-expand",onClick:s(f),disabled:a||y,"aria-label":"Add Custom Field",children:r(O,{})})})]})}try{Q.displayName="ObjectFieldTemplate",Q.__docgenInfo={description:`Derived from the base ObjectFieldTemplate with annotations-editor-specific changes
- Custom button for adding additional properties
- Tracks properties to show a toast message if a property is converted to an additionalProperty because it was
  dropped from the schema (e.g. in a conditional schema)

See https://github.com/rjsf-team/react-jsonschema-form/blob/main/packages/mui/src/ObjectFieldTemplate/ObjectFieldTemplate.tsx`,displayName:"ObjectFieldTemplate",props:{title:{defaultValue:null,description:"A string value containing the title for the object",name:"title",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"A string value containing the description for the object",name:"description",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"A boolean value stating if the object is disabled",name:"disabled",required:!1,type:{name:"boolean"}},properties:{defaultValue:null,description:"An array of objects representing the properties in the object",name:"properties",required:!0,type:{name:"ObjectFieldTemplatePropertyType[]"}},onAddClick:{defaultValue:null,description:"Returns a function that adds a new property to the object (to be used with additionalProperties)",name:"onAddClick",required:!0,type:{name:"(schema: S) => () => void"}},readonly:{defaultValue:null,description:"A boolean value stating if the object is read-only",name:"readonly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"A boolean value stating if the object is required",name:"required",required:!1,type:{name:"boolean"}},hideError:{defaultValue:null,description:"A boolean value stating if the field is hiding its errors",name:"hideError",required:!1,type:{name:"boolean"}},schema:{defaultValue:null,description:"The schema object for this object",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"The uiSchema object for this object field",name:"uiSchema",required:!1,type:{name:"UiSchema<T, S, F>"}},idSchema:{defaultValue:null,description:"An object containing the id for this object & ids for its properties",name:"idSchema",required:!0,type:{name:"IdSchema<T>"}},errorSchema:{defaultValue:null,description:"The optional validation errors in the form of an `ErrorSchema`",name:"errorSchema",required:!1,type:{name:"ErrorSchema<T>"}},formData:{defaultValue:null,description:"The form data for the object",name:"formData",required:!1,type:{name:"Record<string, any> | null"}},formContext:{defaultValue:null,description:"The `formContext` object that was passed to Form",name:"formContext",required:!1,type:{name:"GenericObjectType"}},registry:{defaultValue:null,description:"The `registry` object",name:"registry",required:!0,type:{name:"Registry<T, S, F>"}}}}}catch{}function z(t){const{fields:{ObjectField:e}}=He();return V.useEffect(()=>{const{schema:a,formData:n,onChange:h}=t,s={...n};a[ce]&&(Object.entries(a[ce]).forEach(([m,y])=>{const d=s[m];y[oe]?Array.isArray(d)||(s[m]=K(d)):typeof y=="object"&&"type"in y&&y.type!=="array"&&Array.isArray(d)&&(s[m]=d.map(g=>`${g}`).join(", "))}),$e(n,s)||h(s))}),r(e,{...t})}try{z.displayName="CustomObjectField",z.__docgenInfo={description:"Extends the",displayName:"CustomObjectField",props:{}}}catch{}function ee(t){const{id:e,classNames:a,disabled:n,label:h,onKeyChange:s,readonly:m,required:y,schema:d,children:g,registry:f}=t,{translateString:u}=f,b=u(Me.KeyLabel,[""]);if(!(oe in d))return r("div",{className:a,children:g});const v=({target:S})=>{S&&s(S.value)};return r("div",{className:a,children:p(D,{container:!0,my:1,columnSpacing:2,rowSpacing:0,children:[r(D,{item:!0,xs:3,children:r(be,{fullWidth:!0,required:y,label:b,defaultValue:h,disabled:n||m,id:`${e}-key`,name:`${e}-key`,onBlur:m?void 0:v,type:"text"})}),g]})})}try{ee.displayName="WrapIfAdditionalTemplate",ee.__docgenInfo={description:"The `WrapIfAdditional` component is used by the `FieldTemplate` to rename, or remove properties that are\npart of an `additionalProperties` part of a schema.",displayName:"WrapIfAdditionalTemplate",props:{children:{defaultValue:null,description:"The field or widget component instance for this field row",name:"children",required:!0,type:{name:"ReactNode"}},style:{defaultValue:null,description:"An object containing the style as defined in the `uiSchema`",name:"style",required:!1,type:{name:"StyleHTMLAttributes<any>"}},disabled:{defaultValue:null,description:"A boolean value stating if the field is disabled",name:"disabled",required:!0,type:{name:"boolean"}},label:{defaultValue:null,description:"The computed label for this field, as a string",name:"label",required:!0,type:{name:"string"}},id:{defaultValue:null,description:"The id of the field in the hierarchy. You can use it to render a label targeting the wrapped widget",name:"id",required:!0,type:{name:"string"}},required:{defaultValue:null,description:"A boolean value stating if the field is required",name:"required",required:!1,type:{name:"boolean"}},schema:{defaultValue:null,description:"The schema object for this field",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"The uiSchema object for this field",name:"uiSchema",required:!1,type:{name:"UiSchema<T, S, F>"}},readonly:{defaultValue:null,description:"A boolean value stating if the field is read-only",name:"readonly",required:!0,type:{name:"boolean"}},registry:{defaultValue:null,description:"The `registry` object",name:"registry",required:!0,type:{name:"Registry<T, S, F>"}},onDropPropertyClick:{defaultValue:null,description:"The property drop/removal event handler; Called when a field is removed in an additionalProperty context",name:"onDropPropertyClick",required:!0,type:{name:"(value: string) => () => void"}},classNames:{defaultValue:null,description:"A string containing the base CSS classes, merged with any custom ones defined in your uiSchema",name:"classNames",required:!1,type:{name:"string"}},onKeyChange:{defaultValue:null,description:"The key change event handler; Called when the key associated with a field is changed for an additionalProperty",name:"onKeyChange",required:!0,type:{name:"(value: string) => () => void"}}}}}catch{}function te(t){const{id:e,label:a,children:n,errors:h,help:s,description:m,hidden:y,required:d,displayLabel:g,registry:f,uiSchema:u,schema:b}=t,o=he(u),v=W("WrapIfAdditionalTemplate",f,o),[S,i]=V.useState(!1);return y?r("div",{className:"hidden",children:n}):p(v,{...t,children:[(g||b.type==="boolean")&&p("div",{className:"LabelContainer",children:[p(ye,{htmlFor:e,children:[a,d&&r("span",{className:"required",children:"*"})]}),r(ge,{title:"More Info",children:r(pt,{onClick:T=>{T.preventDefault(),i(!S)},"aria-expanded":S,size:"small",children:r(Fe,{color:"primary",sx:{width:"16px",height:"16px"}})})})]}),n,r(D,{item:!0,xs:12,children:h}),r(Se,{className:"field-description",in:S,children:m}),s]})}try{te.displayName="FieldTemplate",te.__docgenInfo={description:"",displayName:"FieldTemplate",props:{id:{defaultValue:null,description:"The id of the field in the hierarchy. You can use it to render a label targeting the wrapped widget",name:"id",required:!0,type:{name:"string"}},classNames:{defaultValue:null,description:"A string containing the base CSS classes, merged with any custom ones defined in your uiSchema",name:"classNames",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"An object containing the style as defined in the `uiSchema`",name:"style",required:!1,type:{name:"StyleHTMLAttributes<any>"}},label:{defaultValue:null,description:"The computed label for this field, as a string",name:"label",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"A component instance rendering the field description, if one is defined (this will use any custom\n`DescriptionField` defined)",name:"description",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawDescription:{defaultValue:null,description:"A string containing any `ui:description` uiSchema directive defined",name:"rawDescription",required:!1,type:{name:"string"}},children:{defaultValue:null,description:"The field or widget component instance for this field row",name:"children",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},errors:{defaultValue:null,description:"A component instance listing any encountered errors for this field",name:"errors",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawErrors:{defaultValue:null,description:"An array of strings listing all generated error messages from encountered errors for this field",name:"rawErrors",required:!1,type:{name:"string[]"}},help:{defaultValue:null,description:"A component instance rendering any `ui:help` uiSchema directive defined",name:"help",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawHelp:{defaultValue:null,description:"A string containing any `ui:help` uiSchema directive defined. **NOTE:** `rawHelp` will be `undefined` if passed\n`ui:help` is a React component instead of a string",name:"rawHelp",required:!1,type:{name:"string"}},hidden:{defaultValue:null,description:"A boolean value stating if the field should be hidden",name:"hidden",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"A boolean value stating if the field is required",name:"required",required:!1,type:{name:"boolean"}},readonly:{defaultValue:null,description:"A boolean value stating if the field is read-only",name:"readonly",required:!0,type:{name:"boolean"}},hideError:{defaultValue:null,description:"A boolean value stating if the field is hiding its errors",name:"hideError",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"A boolean value stating if the field is disabled",name:"disabled",required:!0,type:{name:"boolean"}},displayLabel:{defaultValue:null,description:`A boolean value stating if the label should be rendered or not. This is useful for nested fields in arrays where
you don't want to clutter the UI`,name:"displayLabel",required:!1,type:{name:"boolean"}},schema:{defaultValue:null,description:"The schema object for this field",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"The uiSchema object for this field",name:"uiSchema",required:!1,type:{name:"UiSchema<T, S, F>"}},formContext:{defaultValue:null,description:"The `formContext` object that was passed to `Form`",name:"formContext",required:!1,type:{name:"GenericObjectType"}},formData:{defaultValue:null,description:"The formData for this field",name:"formData",required:!1,type:{name:"T"}},onChange:{defaultValue:null,description:"The value change event handler; Can be called with a new value to change the value for this field",name:"onChange",required:!0,type:{name:"(newFormData: any, es?: ErrorSchema<any> | undefined, id?: string | undefined) => any"}},onKeyChange:{defaultValue:null,description:"The key change event handler; Called when the key associated with a field is changed for an additionalProperty",name:"onKeyChange",required:!0,type:{name:"(value: string) => () => void"}},onDropPropertyClick:{defaultValue:null,description:"The property drop/removal event handler; Called when a field is removed in an additionalProperty context",name:"onDropPropertyClick",required:!0,type:{name:"(value: string) => () => void"}},registry:{defaultValue:null,description:"The `registry` object",name:"registry",required:!0,type:{name:"Registry<T, S, F>"}}}}}catch{}function ve(t){if(Array.isArray(t)||typeof t=="boolean")return"unknown";const{type:e,enum:a}=t;return e==="array"&&typeof t.items=="object"?`List of ${ve(t.items)}`:a?"enumeration":Array.isArray(e)?e.reduce((n,h)=>`${n}, ${h}`,""):e||"unknown"}function re(t){const{description:e,schema:a}=t,n=ve(a);return r(Se,{className:"field-description",in:!0,children:r(G,{component:"table",className:"FieldDescriptionTable",mb:1,children:p("tbody",{children:[e&&p("tr",{children:[r("th",{children:"Description"}),r("td",{children:e})]}),p("tr",{children:[r("th",{children:"Type"}),r("td",{children:n})]})]})})})}try{re.displayName="FieldDescriptionTable",re.__docgenInfo={description:"",displayName:"FieldDescriptionTable",props:{schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"JSONSchema7"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"ReactNode"}}}}}catch{}function ae(t){const{description:e,schema:a={}}=t;return a.type==="object"?r(U,{variant:"body1",sx:{my:2},children:e}):r(re,{schema:a,description:e})}try{ae.displayName="DescriptionFieldTemplate",ae.__docgenInfo={description:"",displayName:"DescriptionFieldTemplate",props:{id:{defaultValue:null,description:"The id of the field description in the hierarchy",name:"id",required:!0,type:{name:"string"}},schema:{defaultValue:null,description:"The schema object for the field being described",name:"schema",required:!0,type:{name:"RJSFSchema"}},uiSchema:{defaultValue:null,description:"The uiSchema object for this description field",name:"uiSchema",required:!1,type:{name:"UiSchema<any, RJSFSchema, any>"}},description:{defaultValue:null,description:"The description of the field being rendered",name:"description",required:!0,type:{name:"string | ReactElement<any, string | JSXElementConstructor<any>>"}},registry:{defaultValue:null,description:"The `registry` object",name:"registry",required:!0,type:{name:"Registry<any, RJSFSchema, any>"}}}}}catch{}const Tt=["date","datetime-local","file","time"];function ne(t){const{id:e,name:a,placeholder:n,required:h,readonly:s,disabled:m,type:y,label:d,value:g,onChange:f,onChangeOverride:u,onBlur:b,onFocus:o,autofocus:v,options:S,schema:i,uiSchema:T,rawErrors:w=[],formContext:_,registry:l,InputLabelProps:A,...C}=t,E=!0,R=Je(i,y,S),{step:k,min:F,max:L,...$}=R,H={inputProps:{step:k,min:F,max:L,...i.examples?{list:ue(e)}:void 0},...$},q=({target:{value:c}})=>f(c===""?S.emptyValue:c),M=({target:{value:c}})=>b(e,c),x=({target:{value:c}})=>o(e,c),B=Tt.includes(y)?{...A,shrink:!0}:A;let N;return(i.default||i.const)&&(N=JSON.stringify(i.default||i.const)+" (derived)"),p(j,{children:[r(be,{id:e,name:e,placeholder:N||n,label:Ke(d||void 0,E,!1),autoFocus:v,required:!1,disabled:m||s,...H,value:g||g===0?g:"",error:w.length>0,onChange:u||q,onBlur:M,onFocus:x,InputLabelProps:B,...C,inputProps:{"aria-label":e},"aria-describedby":We(e,!!i.examples)}),Array.isArray(i.examples)&&r("datalist",{id:ue(e),children:i.examples.concat(i.default&&!i.examples.includes(i.default)?[i.default]:[]).map(c=>r("option",{value:c},c))})]})}try{ne.displayName="BaseInputTemplate",ne.__docgenInfo={description:"The `BaseInputTemplate` is the template to use to render the basic `<input>` component for the `core` theme.\nIt is used as the template for rendering many of the <input> based widgets that differ by `type` and callbacks only.\nIt can be customized/overridden for other themes or individual implementations as needed.",displayName:"BaseInputTemplate",props:{}}}catch{}function ie(t){const{errors:e=[],idSchema:a}=t;if(e.length===0)return null;const n=Ge(a);return r(mt,{dense:!0,disablePadding:!0,children:e.map((h,s)=>r(ft,{disableGutters:!0,children:r(ut,{id:n,sx:{color:"error.main"},children:h})},s))})}try{ie.displayName="FieldErrorTemplate",ie.__docgenInfo={description:"The `FieldErrorTemplate` component renders the errors local to the particular field",displayName:"FieldErrorTemplate",props:{errorSchema:{defaultValue:null,description:"The errorSchema constructed by `Form`",name:"errorSchema",required:!1,type:{name:"ErrorSchema<T>"}},errors:{defaultValue:null,description:"An array of the errors",name:"errors",required:!1,type:{name:"(string | ReactElement<any, string | JSXElementConstructor<any>>)[]"}},idSchema:{defaultValue:null,description:"The tree of unique ids for every child field",name:"idSchema",required:!0,type:{name:"IdSchema<T>"}},schema:{defaultValue:null,description:"The schema that was passed to field",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"The uiSchema that was passed to field",name:"uiSchema",required:!1,type:{name:"UiSchema<T, S, F>"}},registry:{defaultValue:null,description:"The `registry` object",name:"registry",required:!0,type:{name:"Registry<T, S, F>"}}}}}catch{}function vt(t){return t?ze[t].reduce((e,a)=>(e[`^${a}$`]={not:{}},e),{}):{}}function me(t,e){let a=Re(t);return e&&(a=ke(a)),a}function fe(t){const{entityId:e,schemaId:a,validationSchema:n,liveValidate:h,onSuccess:s=()=>{},onCancel:m,formRef:y,onChange:d,hideActions:g=!1}=t,f=V.useRef(null),u=y??f,[b,o]=P.useState(void 0),[v,S]=P.useState(void 0),[i,T]=P.useState(!1),[w,_]=P.useState(!1),{entityMetadata:l,annotations:A}=at(e,!1,{staleTime:1/0,enabled:!!e,useErrorBoundary:!0}),[C,E]=P.useState(void 0),R=V.useMemo(()=>vt(l==null?void 0:l.concreteType),[l==null?void 0:l.concreteType]),k=V.useCallback(qe(l==null?void 0:l.concreteType),[l==null?void 0:l.concreteType]);V.useEffect(()=>{A&&E(A)},[A]);const{data:F,isLoading:L}=gt(e,{enabled:!!e,refetchOnWindowFocus:!1,useErrorBoundary:!0}),{data:$,isLoading:H}=bt(a??(F==null?void 0:F.jsonSchemaVersionInfo.$id)??"",{enabled:!!a||!!F,useErrorBoundary:!0}),q=n||$,M=L||H,x=nt({onSuccess:()=>{s()},onError:c=>{S(c),T(!0)}});function B(){x.mutate({...me(C,!0),...l})}const N=h??Ae(A,q);return r("div",{className:"JsonSchemaFormContainer",children:M?r("div",{className:"LoadingPlaceholder",children:r(it,{size:30})}):p(j,{children:[l&&F&&p(J,{severity:"info",sx:{mb:2},children:[r("b",{children:l.name})," requires scientific annotations specified by ",r("b",{children:F.jsonSchemaVersionInfo.$id}),". ",r("b",{children:r(ht,{href:`${tt(rt.REPO_ENDPOINT)}/repo/v1/schema/type/registered/${F.jsonSchemaVersionInfo.$id}`,target:"_blank",rel:"noopener noreferrer",children:"View required schema (JSON)"})})]}),l&&Qe(C)&&F===null&&r(J,{severity:"info",children:p(G,{display:"flex",alignItems:"center",gap:.5,children:[p(U,{variant:"smallText1",children:[r("b",{children:l.name})," has no annotations. Click the"," "]}),r(O,{}),r(U,{variant:"smallText1",children:"button to annotate."})]})}),p(we,{validator:Ue,className:"JsonSchemaForm",liveValidate:N,noHtml5Validate:!0,experimental_defaultFormStateBehavior:{emptyObjectFields:"skipDefaults"},fields:{ObjectField:z},templates:{ArrayFieldDescriptionTemplate:Ce,ArrayFieldItemTemplate:Ee,ArrayFieldTemplate:Ne,ArrayFieldTitleTemplate:Ie,BaseInputTemplate:ne,FieldErrorTemplate:ie,FieldTemplate:te,ObjectFieldTemplate:Q,WrapIfAdditionalTemplate:ee,ButtonTemplates:Pe,DescriptionFieldTemplate:ae,ErrorListTemplate:je},ref:u,disabled:x.isLoading,schema:{...q??{},patternProperties:{...(q==null?void 0:q.patternProperties)??{},...R},additionalProperties:(q==null?void 0:q.additionalProperties)??!0},uiSchema:{"ui:options":{copyable:!0,duplicateKeySuffixSeparator:"_"},additionalProperties:{"ui:field":Z}},transformErrors:k,formData:C,onChange:({formData:c})=>{d&&d(c),E(c),o(void 0)},onBlur:()=>{E(me(C,!1))},onSubmit:({formData:c,errors:I},_e)=>{_e.preventDefault(),I&&I.length>0&&o(I),T(!1),E(c),B()},onError:c=>{o(c),(b||N)&&e&&_(!0)},widgets:{TextWidget:De,DateTimeWidget:xe,SelectWidget:Xe,CheckboxWidget:Be},children:[v&&i&&p(J,{severity:"error",sx:{my:2},children:["Annotations could not be updated: ",v.reason]}),!g&&p(j,{children:[r(yt,{sx:{my:2}}),r(G,{display:"flex",justifyContent:"space-between",sx:{gridRowStart:5},children:r(Ye,{hasCancelButton:m!==void 0,onCancel:()=>{m&&m()},onConfirm:()=>{u.current.formElement.current.requestSubmit()},confirmButtonProps:{children:e?"Save":"Validate"}})})]})]}),w&&r(Ze,{open:!0,onConfirm:()=>{B(),_(!1)},onCancel:()=>{_(!1)},title:"Update Annotations",content:p(j,{children:[r("div",{children:"The following errors exist with the annotations you entered:"}),r("div",{children:r("ul",{children:(b??[]).map((c,I)=>p("li",{children:[r("b",{children:`${Oe(c)}: `})," ",`${c.message}`]},I))})}),r("div",{children:"Are you sure you want to save the invalid annotations?"})]}),confirmButtonProps:{children:"Save"}})]})})}try{fe.displayName="SchemaDrivenAnnotationEditor",fe.__docgenInfo={description:`Renders a form for editing an entity's annotations. The component also supports supplying just a schema ID,
but work to support annotation flows without an entity (i.e. before creating entities) is not yet complete.`,displayName:"SchemaDrivenAnnotationEditor",props:{entityId:{defaultValue:null,description:"The entity whose annotations should be edited with the form",name:"entityId",required:!1,type:{name:"string"}},schemaId:{defaultValue:null,description:"If no entity ID is supplied, the schema to use for the form",name:"schemaId",required:!1,type:{name:"string"}},validationSchema:{defaultValue:null,description:"May be used to directly provide a JSON Schema to use for the form",name:"validationSchema",required:!1,type:{name:"JSONSchema7"}},formRef:{defaultValue:null,description:"Optionally supply a ref to the form to handle submission externally with `formRef.current.submit()`.",name:"formRef",required:!1,type:{name:"RefObject<Form<any, RJSFSchema, any>>"}},liveValidate:{defaultValue:null,description:"Provide live input validation. This can cause performance degradation. By default, liveValidate will be true if an entity with a schema and existing annotations is being edited",name:"liveValidate",required:!1,type:{name:"boolean"}},onSuccess:{defaultValue:null,description:"Invoked after a successful form submission",name:"onSuccess",required:!1,type:{name:"(() => void)"}},onCancel:{defaultValue:null,description:"If defined and formRef is not supplied, shows a 'Cancel' button and runs this effect on click",name:"onCancel",required:!1,type:{name:"(() => void)"}},onChange:{defaultValue:null,description:"Passes new form data upon each change to the form",name:"onChange",required:!1,type:{name:"((annotations: Record<string, unknown>) => void)"}},hideActions:{defaultValue:null,description:"If true, the editor will not render its own submit UI.",name:"hideActions",required:!1,type:{name:"boolean"}}}}}catch{}export{O as A,fe as S,er as a,gt as u};
