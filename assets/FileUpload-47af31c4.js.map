{"version":3,"file":"FileUpload-47af31c4.js","sources":["../../src/components/FileUpload/FileUpload.tsx"],"sourcesContent":["import React from 'react'\nimport { Button, ButtonProps } from '@mui/material'\nimport { uploadFile } from '../../synapse-client/SynapseClient'\nimport { useSynapseContext } from '../../utils/context/SynapseContext'\nimport {\n  FileUploadComplete,\n  UploadCallbackResp,\n} from '@sage-bionetworks/synapse-types'\n\nexport type FileUploadProps = {\n  id?: string\n  label?: string\n  buttonProps?: ButtonProps\n  onUploadStart?: () => void\n  onComplete?: (response: UploadCallbackResp) => void\n}\n\nexport const FileUpload: React.FC<FileUploadProps> = props => {\n  const {\n    id,\n    buttonProps = { variant: 'contained' },\n    label = 'Browse...',\n    onUploadStart,\n    onComplete,\n  } = props\n  const { accessToken } = useSynapseContext()\n  const hiddenFileInput = React.useRef<HTMLInputElement>(null)\n\n  const clickHandler = () => {\n    if (hiddenFileInput?.current!) {\n      hiddenFileInput.current?.click()\n    }\n  }\n\n  const changeHandler = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files.length > 0) {\n      if (onUploadStart) {\n        onUploadStart()\n      }\n      const file = e.target.files[0]\n      try {\n        const resp: FileUploadComplete = await uploadFile(\n          accessToken,\n          file.name,\n          file,\n        )\n        if (onComplete) {\n          onComplete({\n            success: true,\n            resp: resp,\n          })\n        }\n      } catch (e) {\n        console.log('FileUpload: fail to upload file', e)\n        if (onComplete) {\n          onComplete({\n            success: false,\n            error: e,\n          })\n        }\n      }\n    }\n  }\n\n  return (\n    <>\n      <input\n        type={'file'}\n        ref={hiddenFileInput}\n        onChange={e => {\n          changeHandler(e)\n        }}\n        style={{ display: 'none' }}\n      />\n      <Button id={id} onClick={clickHandler} {...buttonProps}>\n        {label}\n      </Button>\n    </>\n  )\n}\n\nexport default FileUpload\n"],"names":["FileUpload","props","id","buttonProps","label","onUploadStart","onComplete","accessToken","useSynapseContext","hiddenFileInput","React","clickHandler","_a","changeHandler","file","resp","uploadFile","e2","jsxs","Fragment","jsx","Button"],"mappings":"oMAiBO,MAAAA,EAAAC,GAAA,CACL,KAAA,CAAM,GAAAC,EACJ,YAAAC,EAAA,CAAA,QAAA,WAAA,EACqC,MAAAC,EAAA,YAC7B,cAAAC,EACR,WAAAC,CACA,EAAAL,EAEF,CAAA,YAAAM,GAAAC,IACAC,EAAAC,EAAA,OAAA,IAAA,EAEAC,EAAA,IAAA,OACEF,GAAA,MAAAA,EAAA,WACEG,EAAAH,EAAA,UAAA,MAAAG,EAAA,QACF,EAGFC,EAAA,MAAA,GAAA,CACE,GAAA,EAAA,OAAA,OAAA,EAAA,OAAA,MAAA,OAAA,EAAA,CACER,GACEA,IAEF,MAAAS,EAAA,EAAA,OAAA,MAAA,CAAA,EACA,GAAA,CACE,MAAAC,EAAA,MAAAC,EAAuCT,EACrCO,EAAA,KACKA,CACL,EAEFR,GACEA,EAAA,CAAW,QAAA,GACA,KAAAS,CACT,CAAA,CAEJ,OAAAE,EAAA,CAEA,QAAA,IAAA,kCAAAA,CAAA,EACAX,GACEA,EAAA,CAAW,QAAA,GACA,MAAAW,CACF,CAAA,CAEX,CACF,CACF,EAGF,OAAAC,EAAAC,EAAA,CAAA,SAAA,CAEIC,EAAA,QAAC,CAAA,KAAA,OACO,IAAAX,EACD,SAAA,GAAA,CAEHI,EAAA,CAAA,CAAe,EACjB,MAAA,CAAA,QAAA,MAAA,CACyB,CAAA,EAC3BO,EAAAC,EAAA,CAAA,GAAAnB,EAAA,QAAAS,EAAA,GAAAR,EAAA,SAAAC,EAAA,CAGA,CAAA,CAAA,CAGN"}