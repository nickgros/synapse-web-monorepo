import{j as u,F as M,a as E}from"./jsx-runtime-9dc53467.js";import{d as Y}from"./dayjs.min-f79c4412.js";import{z as D,C as V,L as G,J as z,K as F,N as P,Q as $,T as H}from"./SynapseConstants-c93e8ee4.js";import{f as K}from"./DateFormatter-23c86375.js";import{T as p}from"./Typography-62cfc992.js";import{M as q}from"./Tooltip-e8bd1358.js";import{I as B}from"./InfoTwoTone-bbc735a3.js";import{B as J}from"./Box-737945d6.js";import{L as W}from"./Link-adab3de3.js";import{r as s}from"./index-76fb7be0.js";function S(e){const t=s.useRef(e);return t.current=e,s.useMemo(()=>Object.freeze({get current(){return t.current}}),[])}const O=()=>{},l=typeof window<"u"&&typeof navigator<"u"&&typeof document<"u";function Q(e,...t){var r;(r=e==null?void 0:e.addEventListener)==null||r.call(e,...t)}function k(e,...t){var r;(r=e==null?void 0:e.removeEventListener)==null||r.call(e,...t)}function C(){const e=s.useRef(!0);return s.useEffect(()=>{e.current=!1},[]),e.current}const X=l?s.useLayoutEffect:s.useEffect;function Z(e,t){const r=C();s.useEffect(r?O:e,t)}function b(e,t){return typeof e=="function"?e(t):e}const d=new Map,T=(e,t,r,n)=>{var o,f;(f=(o=d.get(e))==null?void 0:o.get(t))==null||f.forEach(i=>{i!==n&&i(r)})},U=e=>{e.storageArea&&e.key&&e.newValue&&T(e.storageArea,e.key,e.newValue)},j=(e,t,r)=>{l&&d.size===0&&Q(window,"storage",U,{passive:!0});let n=d.get(e);n||(n=new Map,d.set(e,n));let o=n.get(t);o||(o=new Set,n.set(t,o)),o.add(r)},ee=(e,t,r)=>{const n=d.get(e);if(!n)return;const o=n.get(t);o&&(o.delete(r),o.size||n.delete(t),n.size||d.delete(e),l&&!d.size&&k(window,"storage",U))},te={defaultValue:null,initializeWithValue:!0};function ne(e,t,r){var y;const n=S({...te,...r}),o=(a,c)=>(n.current.parse??oe)(a,c),f=a=>(n.current.stringify??re)(a),i=S({fetchRaw:()=>e.getItem(t),fetch:()=>o(i.current.fetchRaw(),n.current.defaultValue),remove(){e.removeItem(t)},store(a){const c=f(a);return c!==null&&e.setItem(t,c),c}}),R=C(),[g,h]=s.useState((y=n.current)!=null&&y.initializeWithValue&&R?i.current.fetch():void 0),_=S(g),L=S({fetch(){h(i.current.fetch())},setRawVal(a){h(o(a,n.current.defaultValue))}});Z(()=>{L.current.fetch()},[t]),s.useEffect(()=>{n.current.initializeWithValue||L.current.fetch()},[]),X(()=>{const a=L.current.setRawVal;return j(e,t,a),()=>{ee(e,t,a)}},[e,t]);const m=S({set(a){if(!l)return;const c=b(a,_.current),w=i.current.store(c);w!==null&&T(e,t,w)},delete(){l&&(i.current.remove(),T(e,t,null))},fetch(){l&&T(e,t,i.current.fetchRaw())}}),v=s.useMemo(()=>({set:a=>{m.current.set(a)},remove(){m.current.delete()},fetch(){m.current.fetch()}}),[]);return s.useMemo(()=>({value:g,...v}),[g])}const re=e=>{if(e===null)return null;try{return JSON.stringify(e)}catch(t){return console.warn(t),null}},oe=(e,t)=>{if(e===null)return t;try{return JSON.parse(e)}catch(r){return console.warn(r),t}};let I;try{I=l&&!!window.localStorage}catch{I=!1}const A=I?(e,t)=>ne(localStorage,e,t):(e,t)=>({value:void 0,set:O,remove:O,fetch:O}),Ae=[D,V,G];function ae(e){switch(e){case D:return"Google";case V:return"ORCiD";case G:return"your email";default:return"unknown login method"}}function ie(){return{currentSourceAppNameState:A(z),lastLoginMethodState:A(F),lastLoginSourceAppNameState:A(P),lastLoginSourceAppURLState:A($),lastLoginDateState:A(H)}}function he(){const e=ie();return{currentSourceAppName:e.currentSourceAppNameState.value,lastLoginMethod:e.lastLoginMethodState.value,lastLoginSourceAppName:e.lastLoginSourceAppNameState.value,lastLoginSourceAppURL:e.lastLoginSourceAppURLState.value,lastLoginDate:e.lastLoginDateState.value}}function se(e){return e.match(/^[aeiou]/i)?"an":"a"}function x(e){return e.match(" Portal$")?"the ":""}function N(e){const{currentSourceAppName:t,lastLoginMethod:r,lastLoginSourceAppName:n,lastLoginSourceAppURL:o,lastLoginDate:f,display:i}=e;if(!(t&&r&&n&&o&&f&&t!==n))return null;const g=se(t),h=x(t),_=x(n),L=`You may already have ${g} ${t} account`,m=`Account last used on ${K(Y(f),"MMMM D, YYYY")}`,v=E(M,{children:[u(p,{variant:"smallText2",mb:1,children:L}),u(p,{variant:"smallText1",mb:1,color:"white",children:`This computer was used to sign in to an account on ${_}${n}. 
          You can use the same account to sign in to ${h}${t}.`}),u(p,{variant:"smallText1",color:"white",children:m})]}),y=E(M,{children:[u(p,{variant:"smallText2",mb:1,sx:{color:"grey.900",fontSize:"12px"},children:L}),E(p,{variant:"smallText1",mb:1,sx:{color:"grey.900",fontSize:"12px"},children:["It looks like you already have an account, last used on"," ",_,u(W,{href:o,children:n}),"."," ",`You can use this account to sign in via ${ae(r)}.`]}),u(p,{variant:"smallText1",sx:{color:"grey.700",fontSize:"10px"},children:m})]});return u(M,{children:i==="sentence"?E(p,{variant:"smallText1",sx:{color:"grey.700",textTransform:"none"},children:["You may be able to use an existing account",u(q,{title:v,placement:"top",componentsProps:{tooltip:{sx:{bgcolor:"#63676C","& .MuiTooltip-arrow":{color:"#63676C"}}}},children:u(B,{sx:{color:"grey.700",width:"12px",height:"12px",ml:"4px",verticalAlign:"middle"}})})]}):u(J,{sx:{backgroundColor:"grey.100",p:"10px"},children:y})})}try{N.displayName="LastLoginInfo",N.__docgenInfo={description:"",displayName:"LastLoginInfo",props:{currentSourceAppName:{defaultValue:null,description:"",name:"currentSourceAppName",required:!0,type:{name:"string | undefined"}},lastLoginMethod:{defaultValue:null,description:"",name:"lastLoginMethod",required:!0,type:{name:"enum",value:[{value:"undefined"},{value:'"GOOGLE"'},{value:'"ORCID"'},{value:'"EMAIL"'}]}},lastLoginSourceAppName:{defaultValue:null,description:"",name:"lastLoginSourceAppName",required:!0,type:{name:"string | undefined"}},lastLoginSourceAppURL:{defaultValue:null,description:"",name:"lastLoginSourceAppURL",required:!0,type:{name:"string | undefined"}},lastLoginDate:{defaultValue:null,description:"",name:"lastLoginDate",required:!0,type:{name:"string | undefined"}},display:{defaultValue:null,description:"",name:"display",required:!0,type:{name:"enum",value:[{value:'"sentence"'},{value:'"box"'}]}}}}}catch{}export{N as L,Ae as a,S as b,A as c,ae as g,he as u};
