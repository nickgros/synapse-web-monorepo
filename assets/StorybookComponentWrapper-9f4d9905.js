import{j as P,a as O}from"./jsx-runtime-ad672792.js";import{r as i,R as S}from"./index-f1f749bf.js";import{P as E,o as T,a as b,b as v,s as x,g as A,i as D,c as I,d as _,e as N,S as Q,f as U,h as F}from"./SynapseContext-d9d41f69.js";import{S as L}from"./ToastMessage-306d2a68.js";import{d as M}from"./dayjs.min-e0adaab4.js";import{P as j,B as g,S as q}from"./getEndpoint-5374ab4d.js";import{d as B,F as G,a as W,p as H,s as K,m as V,b as $,c as z,n as J,e as X,f as Y,g as Z,h as ee,i as te,j as oe}from"./FullContextProvider-2e293237.js";import{M as ae}from"./react-router-b06b9355.js";import{Q as ne}from"./queryClient-a133b3a7.js";function re(e={}){const{onSignInComplete:o,registerAccountUrl:a=`${j.PORTAL}#!RegisterAccount:0`,onError:t,onTwoFactorAuthRequired:p}=e,c=A(),k=new URL(window.location.href),{searchParams:n}=k,l=n==null?void 0:n.get("code"),r=n==null?void 0:n.get("provider"),C=n==null?void 0:n.get("state"),[w,f]=i.useState(!!(l&&r));return i.useEffect(()=>{if(l&&r){const y=`${c}?provider=${r}`;if(E.GOOGLE==r){const m=s=>{"accessToken"in s?x(s.accessToken).then(o):p&&p(s)},u=s=>{s.status===404&&window.location.replace(a),console.error("Error with Google account association: ",s),t&&t(s.reason)};C?T(C,r,l,y,g.REPO_ENDPOINT).then(m).catch(u).finally(()=>f(!1)):b(r,l,y,g.REPO_ENDPOINT).then(m).catch(u).finally(()=>f(!1))}else if(E.ORCID==r){const m=u=>{console.error("Error binding ORCiD to account: ",u),t&&t(u.reason)};v(r,l,y,g.REPO_ENDPOINT).then(o).catch(m).finally(()=>f(!1))}else console.warn("Unknown SSO Provider: ",r),f(!1)}},[]),{isLoading:w}}var h={},se={get exports(){return h},set exports(e){h=e}};se.exports={ReactQueryDevtools:function(){return null},ReactQueryDevtoolsPanel:function(){return null}};async function ie(){let e=await _(),o;try{o=await N(e)}catch(t){throw t instanceof Q&&t.status===401&&(console.error("Encountered error fetching profile: ",t,"Signing out..."),await U(),e=void 0),t}let a;return e&&F(e).then(t=>{a=M(t.authenticatedOn).format("L LT")}),{accessToken:e,profile:o,authenticatedOn:a}}const d=new ne(B);function ce(e){const o=q[e];window.SRC={OVERRIDE_ENDPOINT_CONFIG:o},d.resetQueries()}const le={default:H,sageBionetworks:K,mtb:V,arkPortal:$,adKnowledgePortal:z,nfPortal:J,bsmnPortal:X,psychEncodePortal:Y,stopAdPortal:Z,digitalHealthPortal:ee,crcResearcherPortal:te,cancerComplexityPortal:oe};function R(e){const{storybookContext:o}=e;i.useEffect(()=>{ce(o.globals.stack)},[o.globals.stack]);const[a,t]=S.useState(void 0);re(),i.useEffect(()=>{ie().then(c=>{t(c.accessToken)})}),i.useEffect(()=>{async function c(){await d.cancelQueries(),d.removeQueries(),await d.invalidateQueries()}c()},[a]);const p=i.useMemo(()=>({accessToken:a,isInExperimentalMode:D(),utcTime:I(),withErrorBoundary:!0,downloadCartPageUrl:"/?path=/story/download-downloadcartpage--demo"}),[a]);return P(G,{queryClient:d,synapseContext:p,theme:{...W,palette:le[o.globals.palette]},children:O(ae,{children:[o.globals.showReactQueryDevtools&&P(h.ReactQueryDevtools,{}),P(L,{}),P("main",{children:e.children})]})},a)}try{R.displayName="StorybookComponentWrapper",R.__docgenInfo={description:"Wraps storybook story components to ensure that all components receive required context.",displayName:"StorybookComponentWrapper",props:{storybookContext:{defaultValue:null,description:"",name:"storybookContext",required:!0,type:{name:"any"}}}}}catch{}export{R as S,ie as s};
//# sourceMappingURL=StorybookComponentWrapper-9f4d9905.js.map
