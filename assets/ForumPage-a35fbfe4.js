import{a as o,j as e,F as L}from"./jsx-runtime-095bf462.js";import{r as u}from"./index-8db94870.js";import{c8 as s,D as t,a2 as y,b as M,c9 as A}from"./SynapseClient-a57981a2.js";import"./EntityTypeUtils-28f5c3c2.js";import{S as k,X as V,h as O}from"./SynapseConstants-351603e3.js";import"./getEndpoint-ac94413e.js";import{u as U,a as B}from"./useForum-963a427c.js";import{u as P}from"./useSubscription-636c3e35.js";import{d as q}from"./ToastMessage-27c60e7f.js";import{d as x}from"./dayjs.min-8d4ef725.js";import{S as T}from"./Sort-52b60bfe.js";import{I as Y}from"./IconSvg-5d52c249.js";import{U as g}from"./UserCard-fc7bb400.js";import{T as j}from"./Table-15895184.js";import{L as G}from"./Link-c02845c3.js";import{B as E}from"./Button-5c815620.js";import{F as H}from"./ForumThreadEditor-0f122150.js";import{S as X}from"./SubscribersModal-e4b9b28e.js";import{a as z}from"./ConfirmationDialog-fbfc50bb.js";import{T as W}from"./Typography-387311b4.js";const C=({forumId:i,limit:m,filter:h,onClickLink:N})=>{const[a,S]=u.useState(s.PINNED_AND_LAST_ACTIVITY),[n,l]=u.useState(!1),{data:p,hasNextPage:b,fetchNextPage:D}=U(i,m,a,n,h),_=(p==null?void 0:p.pages.flatMap(r=>r.results))??[],c=r=>{a==r?(S(r),l(!n)):(S(r),l(!1))};return o("div",{className:"ForumTable bootstrap-4-backport",children:[o(j,{children:[e("thead",{children:o("tr",{children:[e("th",{children:o("span",{className:"SRC-split",children:[e("span",{children:"Topic"}),e(T,{role:"button","aria-label":"Sort by Topic",active:a===s.THREAD_TITLE,direction:a==="THREAD_TITLE"?n===!1?t.DESC:t.ASC:t.DESC,onClick:()=>c(s.THREAD_TITLE)})]})}),e("th",{children:"Author"}),e("th",{children:"Active Users"}),e("th",{children:o("span",{className:"SRC-split",children:[e("span",{children:"Replies"}),e(T,{role:"button","aria-label":"Sort by Replies",active:a===s.NUMBER_OF_REPLIES,direction:a==="NUMBER_OF_REPLIES"?n===!1?t.DESC:t.ASC:t.DESC,onClick:()=>c(s.NUMBER_OF_REPLIES)})]})}),e("th",{children:o("span",{className:"SRC-split",children:[e("span",{children:"Views"}),e(T,{role:"button","aria-label":"Sort by Views",active:a===s.NUMBER_OF_VIEWS,direction:a==="NUMBER_OF_VIEWS"?n===!1?t.DESC:t.ASC:t.DESC,onClick:()=>c(s.NUMBER_OF_VIEWS)})]})}),e("th",{children:o("span",{className:"SRC-split",children:[e("span",{children:"Activity"}),e(T,{role:"button","aria-label":"Sort by Last Activity",active:a===s.PINNED_AND_LAST_ACTIVITY,direction:a==="PINNED_AND_LAST_ACTIVITY"?n===!1?t.DESC:t.ASC:t.DESC,onClick:()=>c(s.PINNED_AND_LAST_ACTIVITY)})]})})]})}),e("tbody",{children:_.map(r=>o("tr",{children:[e("td",{children:o(G,{onClick:()=>N(r.id),children:[r.isPinned?e(Y,{icon:"pushpin"}):e(L,{}),r.title]})}),e("td",{children:e(g,{size:k,ownerId:r.createdBy})}),e("td",{children:r.activeAuthors.map(f=>e("div",{className:"avatarContainer",children:e(g,{showCardOnHover:!0,className:"ActiveUsers",size:V,avatarSize:"MEDIUM",ownerId:f})},f))}),e("td",{children:r.numberOfReplies}),e("td",{children:r.numberOfViews}),e("td",{children:x(r.lastActivity).format("L")})]},r.id))})]}),b&&e(E,{variant:"outlined",color:"primary",onClick:()=>{D()},children:"Show more results"})]})};try{C.displayName="ForumTable",C.__docgenInfo={description:"",displayName:"ForumTable",props:{forumId:{defaultValue:null,description:"",name:"forumId",required:!0,type:{name:"string"}},limit:{defaultValue:null,description:"",name:"limit",required:!0,type:{name:"number"}},onClickLink:{defaultValue:null,description:"",name:"onClickLink",required:!0,type:{name:"(threadId: string) => void"}},filter:{defaultValue:null,description:"",name:"filter",required:!0,type:{name:"enum",value:[{value:'"NO_FILTER"'},{value:'"DELETED_ONLY"'},{value:'"EXCLUDE_DELETED"'}]}}}}}catch{}const J="You will need to sign in for access to that resource",v=({forumId:i,limit:m,onClickLink:h})=>{const[N,a]=u.useState(!1),[S,n]=u.useState(!1),[l,p]=u.useState(!1),[b,D]=u.useState(!1),{subscription:_,isLoading:c,toggleSubscribed:r}=P(i,y.FORUM);function f(){try{r()}catch(w){q(w.reason,"danger")}}const{data:I}=B(i),{data:d}=M(),R=I==null?void 0:I.results.includes((d==null?void 0:d.ownerId)??""),F=()=>{(d==null?void 0:d.userName)=="anonymous"?n(!0):a(!0)};return o("div",{className:"ForumTable bootstrap-4-backport",children:[o("div",{className:"ForumTable__top-level-control",children:[e(X,{id:i,objectType:y.FORUM,showModal:b,handleModal:D}),e(E,{variant:_?"outlined":"contained",color:"primary",onClick:()=>f(),disabled:c,children:_?"Unfollow":"Follow"}),e(E,{variant:"contained",color:"primary",onClick:()=>F(),children:"New Thread"}),R&&e(E,{variant:"contained",color:"primary",onClick:()=>p(!l),children:l?"Hide Deleted Threads":"Show Deleted Threads"})]}),l&&o(L,{children:[e(W,{variant:"h4",children:"Deleted Threads"}),e(C,{onClickLink:h,forumId:i,limit:m,filter:A.DELETED_ONLY})]}),e(C,{onClickLink:h,forumId:i,limit:m,filter:A.EXCLUDE_DELETED}),e(H,{isReply:!1,id:i,onClose:()=>a(!1),isDialog:!0,openDialog:N}),e(z,{open:S,title:"Sign In Required",content:J,onCancel:()=>n(!1),hasCancelButton:!1,onConfirm:()=>n(!1),confirmButtonText:"Sign In",confirmButtonClassName:O})]})};try{v.displayName="ForumPage",v.__docgenInfo={description:"",displayName:"ForumPage",props:{forumId:{defaultValue:null,description:"",name:"forumId",required:!0,type:{name:"string"}},limit:{defaultValue:null,description:"",name:"limit",required:!0,type:{name:"number"}},onClickLink:{defaultValue:null,description:"",name:"onClickLink",required:!0,type:{name:"(threadId: string) => void"}}}}}catch{}export{v as F};
//# sourceMappingURL=ForumPage-a35fbfe4.js.map
