{"version":3,"file":"ChangePassword.stories-1e1b9641.js","sources":["../../src/lib/containers/ChangePassword.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { FormGroup, FormControl, FormLabel, Button } from 'react-bootstrap'\nimport { ChangePasswordWithCurrentPassword } from '../utils/synapseTypes/ChangePasswordRequests'\nimport { displayToast } from './ToastMessage'\nimport { SynapseClient } from '../utils'\nimport { useSynapseContext } from '../utils/SynapseContext'\nimport { UserProfile } from '../utils/synapseTypes'\n\nconst ChangePassword: React.FunctionComponent = () => {\n  const { accessToken } = useSynapseContext()\n  const [oldPassword, setOldPassword] = useState<string>('')\n  const [newPassword, setNewPassword] = useState<string>('')\n  const [confirmPassword, setConfirmPassword] = useState<string>('')\n  const [currentUserProfile, setUserProfile] = useState<UserProfile>()\n\n  useEffect(() => {\n    async function getUserProfile() {\n      const userProfile = await SynapseClient.getUserProfile(accessToken)\n      setUserProfile(userProfile)\n    }\n    if (accessToken) {\n      getUserProfile()\n    } else {\n      setUserProfile(undefined)\n    }\n  }, [accessToken])\n\n  const handleChangePassword = async (\n    clickEvent: React.FormEvent<HTMLElement>,\n  ) => {\n    clickEvent.preventDefault()\n    try {\n      if (newPassword !== confirmPassword) {\n        displayToast(\n          'New password and confirm password does not match.',\n          'danger',\n        )\n      } else if (accessToken) {\n        const changeRequest: ChangePasswordWithCurrentPassword = {\n          newPassword,\n          concreteType:\n            'org.sagebionetworks.repo.model.auth.ChangePasswordWithCurrentPassword',\n          username: currentUserProfile?.userName!,\n          currentPassword: oldPassword,\n        }\n        await SynapseClient.changePasswordWithCurrentPassword(\n          changeRequest,\n          accessToken,\n        )\n          .then(() => displayToast('Successfully changed', 'success'))\n          .catch((err: any) => displayToast(err.reason as string, 'danger'))\n      }\n    } catch (err) {\n      displayToast(err.reason as string, 'danger')\n    }\n  }\n\n  return (\n    <div className=\"changePassword\">\n      <form\n        onSubmit={e => {\n          handleChangePassword(e)\n        }}\n      >\n        <FormGroup controlId=\"oldPassword\">\n          <FormLabel>Current Password</FormLabel>\n          <FormControl\n            type=\"password\"\n            onChange={e => setOldPassword(e.target.value)}\n            value={oldPassword}\n          />\n        </FormGroup>\n        <FormGroup controlId=\"newPassword\">\n          <FormLabel>New Password</FormLabel>\n          <FormControl\n            type=\"password\"\n            onChange={e => setNewPassword(e.target.value)}\n            value={newPassword}\n          />\n        </FormGroup>\n        <FormGroup controlId=\"confirmPassword\">\n          <FormLabel>Confirm Password</FormLabel>\n          <FormControl\n            type=\"password\"\n            onChange={e => setConfirmPassword(e.target.value)}\n            value={confirmPassword}\n          />\n        </FormGroup>\n        <Button\n          type=\"submit\"\n          onSubmit={e => {\n            handleChangePassword(e)\n          }}\n        >\n          Change Password\n        </Button>\n      </form>\n    </div>\n  )\n}\n\nexport default ChangePassword\n"],"names":["ChangePassword","accessToken","useSynapseContext","oldPassword","setOldPassword","useState","newPassword","setNewPassword","confirmPassword","setConfirmPassword","currentUserProfile","setUserProfile","useEffect","getUserProfile","userProfile","SynapseClient.getUserProfile","handleChangePassword","clickEvent","displayToast","changeRequest","SynapseClient.changePasswordWithCurrentPassword","err","jsx","jsxs","e","FormGroup","FormLabel","FormControl","Button"],"mappings":"khDAQA,MAAAA,EAAA,IAAA,CACE,KAAA,CAAA,YAAAC,GAAAC,IACA,CAAAC,EAAAC,CAAA,EAAAC,EAAA,SAAA,EAAA,EACA,CAAAC,EAAAC,CAAA,EAAAF,EAAA,SAAA,EAAA,EACA,CAAAG,EAAAC,CAAA,EAAAJ,EAAA,SAAA,EAAA,EACA,CAAAK,EAAAC,CAAA,EAAAN,EAAA,SAAA,EAEAO,EAAAA,UAAA,IAAA,CACE,eAAAC,GAAA,CACE,MAAAC,EAAA,MAAAC,EAAAd,CAAA,EACAU,EAAAG,CAAA,CAA0B,CAE5Bb,EACEY,IAEAF,EAAA,MAAA,CACF,EAAA,CAAAV,CAAA,CAAA,EAGF,MAAAe,EAAA,MAAAC,GAAA,CAGEA,EAAA,eAAA,EACA,GAAA,CACE,GAAAX,IAAAE,EACEU,EAAA,oDACE,QACA,UACFjB,EAAA,CAEA,MAAAkB,EAAA,CAAyD,YAAAb,EACvD,aAAA,wEAEE,SAAAI,GAAA,YAAAA,EAAA,SAC4B,gBAAAP,CACb,EAEnB,MAAAiB,EAAoBD,EAClBlB,CACA,EAAA,KAAA,IAAAiB,EAAA,uBAAA,SAAA,CAAA,EAAA,MAAAG,GAAAH,EAAAG,EAAA,OAAA,QAAA,CAAA,EAIJ,OAAAA,EAAA,CAEAH,EAAAG,EAAA,OAAA,QAAA,CAA2C,CAC7C,EAGF,OAAAC,EAAA,MAAA,CAAA,UAAA,iBAAA,SAAAC,EAEI,OAAC,CAAA,SAAAC,GAAA,CAEGR,EAAAQ,CAAA,CAAsB,EACxB,SAAA,CAEAD,EAAAE,EAAA,CAAA,UAAA,cAAA,SAAA,CACEH,EAAAI,EAAA,CAAA,SAAA,kBAAA,CAAA,EAA2BJ,EAC3BK,EAAC,CAAA,KAAA,WACM,SAAAH,GAAApB,EAAAoB,EAAA,OAAA,KAAA,EACuC,MAAArB,CACrC,CAAA,CACT,EAAA,EACFoB,EAAAE,EAAA,CAAA,UAAA,cAAA,SAAA,CAEEH,EAAAI,EAAA,CAAA,SAAA,cAAA,CAAA,EAAuBJ,EACvBK,EAAC,CAAA,KAAA,WACM,SAAAH,GAAAjB,EAAAiB,EAAA,OAAA,KAAA,EACuC,MAAAlB,CACrC,CAAA,CACT,EAAA,EACFiB,EAAAE,EAAA,CAAA,UAAA,kBAAA,SAAA,CAEEH,EAAAI,EAAA,CAAA,SAAA,kBAAA,CAAA,EAA2BJ,EAC3BK,EAAC,CAAA,KAAA,WACM,SAAAH,GAAAf,EAAAe,EAAA,OAAA,KAAA,EAC2C,MAAAhB,CACzC,CAAA,CACT,EAAA,EACFc,EACAM,EAAC,CAAA,KAAA,SACM,SAAAJ,GAAA,CAEHR,EAAAQ,CAAA,CAAsB,EACxB,SAAA,iBACD,CAAA,CAED,CAAA,CAAA,CAAA,CAAA,CAIR"}